[Service]
# Run chrony as the package user on Noble
User=_chrony
Group=avahi

# Let systemd create writable runtime dir for that user
RuntimeDirectory=chrony
RuntimeDirectoryMode=0777
RuntimeDirectoryPreserve=yes

# Defensive: ensure dir exists with correct owner (no-op if already created)
ExecStartPre=-/usr/bin/install -d -o _chrony -g avahi -m 0777 /run/chrony

# Caps needed inside container (matches your pod securityContext)
CapabilityBoundingSet=CAP_SYS_TIME CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_SYS_TIME CAP_NET_BIND_SERVICE
